\chapter{Дискретизация и квантование}
\ttl
\textbf{Задача 4.26}. Непрерывный сигнал $x(t )$, имеющий спектр $X(j\omega)$ дискретизируется с частотой дискретизации $\omega_{д}$ (вид $X(j\omega)$ и значение $\omega_{д}$ задаются на риcунке~\ref{sign}). Выполняется ли в данном случае условие теоремы Котельникова? Построить график спектра дискретизированного сигнала (изобразить 5 периодов спектра). Проиллюстрировать графически процесс восстановления спектра непрерывного сигнала с помощью идеального интерполирующего фильтра в частотной области.
\begin{figure}[h]
  \center
 \includegraphics{signal.pdf}
  \caption{Вид сигнала}\label{sign}
 \end{figure}
\begin{center}
\textbf{Решение}
\end{center}

Согласно теореме Котельникова, сигнал $x(t)$, имеющий ограниченный \linebreak спектр, может быть восстановлен однозначно и без потерь по своим дискретным отсчётам, взятым с частотой не менее удвоенной максимальной частоты спектра $\omega_{max}$:
$$ \omega_д \ge 2 \omega_{max}. $$

В данном случае, из предложенного графика непрерывного сигнала видно, что частота дискретизации меньше удвоенной  частоты максимальной частоты, то есть условие теоремы Котельникова не выполняется.

Спектр дискретного сигнала можно построить, используя формулу:
\[ X_{д} (j\omega) = f_д \sum_{i=-\infty}^{\infty} X\left[j(\omega - k\omega_д)\right]. \]

$ X_д (j\omega) = f_д [\ldots + X(j(\omega + 2\omega_д)) + X(j(\omega + \omega_д)) + X(j\omega) +  X(j(\omega  - \omega_д))\hm + X(j(\omega + 2\omega_д))\hm \ldots]$.

Процесс построения графика спектра дискретизированного сигнала представлен на рисунке \ref{spec}. Этот график  строится посредством суммирования его отдельных периодов.
\begin{figure}[h]
  \center
 \includegraphics{spectr.pdf}
  \caption{Спектр дискретизированного сигнала}\label{spec}
 \end{figure}
 
Процесс восстановления непрерывного сигнала по дискретному (рису-\linebreak нок~\ref{rest}) заключается в подаче дискретного сигнала на вход интерполятора. При этом спектр выходного сигнала $ \hat{X}(j\omega) $ описывается функцией:
$$ \hat{X}(j\omega) = X_д (j\omega) H(j\omega) \mbox { , где }$$

$ H(j\omega) = \begin{cases}
\dfrac{1}{f_д} & при  -\frac{\omega_д}{2}  \leq \omega \leq  \frac{\omega_д}{2} ;\\ 
0 & \text{при других $ \omega $} .\\
\end{cases} $
   \begin{figure}[h]
  \center
 \includegraphics{restore.pdf}
  \caption{Процесс восстановления сигнала}\label{rest}
 \end{figure}

Таким образом, по дискретизированному сигналу нельзя точно восстановить спектр $ X(j\omega) $ функции $x(t)$, а, следовательно, и саму эту функцию.

\textbf{Ответ}: условие теоремы Котельникова не выполняется, сигнал не может быть восстановлен.

\textbf{Задача 4.56}. Непрерывный сигнал $x(t)=\cos(\omega_0 t+\varphi)$ дискретизируется с частотой дискретизации $\omega_д $. Построить графики непрерывного и дискретизированного сигналов (изобразить не менее пяти периодов). Проиллюстрировать графически процесс восстановления непрерывного сигнала по дискретному во временной области с помощью интерполятора 0-го порядка. Значение $\omega_0 =3 $ , $\omega_д = 5$~, $\varphi=0$.
\newpage
\begin{center}
\textbf{Решение}
\end{center}

Вид непрерывного сигнала $x(t)=\cos(3t)$  представлен на рисунке \ref{osif} . Период функции $ T = \frac{2\pi}{\omega_0} = \frac{2\pi}{3} $, пероид дискретизации $ \Delta t = \frac{1}{5f_д}=\frac{3}{5f_0}=\frac{3}{5}T $. По найденным отсчётам строится график дискретизированного сигнала $ X_д(t) $.
   \begin{figure}[h]
  \center
 \includegraphics{ocifr.png}
  \caption{Дискретизация сигнала}\label{osif}
 \end{figure}

Процесс восстановления непрерывного сигнала по дискретному осуществляется с помощью интерполирующего фильтра нулевого порядка. Во временной области процесс преобразования входного сигнала фильтром описывается уравнением:
$$ X^*(t) = \sum_{k = -\infty}^{+\infty} X_д (k \Delta t)h_и (t-k\Delta t), $$

где $ h_и(t) $ --- импульсная характеристика интерполирующего фильтра. На рисунке \ref{inter}  изображён вид этой характеристики для интерполятора нулевого порядка.

 \begin{figure}[h]
  \center
 \includegraphics{interpol}
  \caption{Интерполятор нулевого порядка}\label{inter}
 \end{figure}
 
 Уравнение выходного сигнала:
 
$ X^*(t) = \ldots X_д(-2 \Delta t)h_0(t+2 \Delta t) +X_д(- \Delta t)h_0(t+ \Delta t) +X_д(0)h_0(t)\hm + X_д( \Delta t)h_0(t- \Delta t) +X_д(2 \Delta t)h_0(t-2 \Delta t) \ldots $

Процесс восстановления непрерывного сигнала можно увидеть на ри-\linebreak сунке \ref{res} . Искомый сигнал получается в результате суммирования его отдельных составляющих.

  \begin{figure}[h]
  \center
 \includegraphics{diskret.pdf}
  \caption{Процесс восстановления сигнала}\label{res}
 \end{figure}


\textbf{Задача 4.77}. Непрерывное сообщение $u(t)$ квантуется с округлением с постоянным шагом $ \Delta u $ при числе уровней квантования $N_y=100$. Плотность распределения вероятностей сообщения $w_U(u)$ --- равномерная в интервале от $-U_m$ до $U_m$, т.е $ w_u  = \begin{cases}
\dfrac{1}{2U_m} , & -U_m \leq u \leq U_m;\\
0, &\text{при других $ U $.}
\end{cases} $ 

Определить соотношение сигнал --- шум в квантованном сообщении.
\begin{center}
\textbf{Решение}
\end{center}

Соотношение сигнал --- шум можно определить как отношение мощности сигнала к мощности шума:
$$ h^2 = \frac{P_с}{P_ш} .\eqno(6)$$ 

Мошность сигнала $ P_с $ и мощность шума $ P_ш $ определяются как дисперсии сигнала и шума соответственно.
$$ P_c = D_c = \int_{-\infty}^{+\infty} (u - M_u)^2 w_U(u)du, .\eqno(7)$$ 
где $ M_u $ --- математическое ожидание, которое определяется как 

$ M_u =  \displaystyle\int_{-\infty}^{+\infty} uw_U(u)du  = \int_{-U_0}^{U_0}\frac{1}{2U_0}Udu =\left. \frac{1}{2U_0}\cdot \frac{u^2}{2}\right|_{-U_0}^{U_0}=\frac{1}{2U_0} \left( \frac{U_0^2}{2}-\frac{U_0^2}{2}  \right)\hm=0 $ , тогда по формуле (7)

$ P_c = \displaystyle \int_{-U_0}^{U_0} \frac{u^2}{2U_0}du =\left. \frac{1}{2U_0}\frac{u^3}{3}\right|_{-U_0}^{U_0} = \frac{1}{2U_0}\left(\frac{U_0^3}{3}+\frac{U_0^3}{3}\right) = \frac{U_0^3}{3} $ .

При квантовании с округлением мощность шума равна:
$$ P_ш = D_ш = \frac{\Delta u^2}{12} .\eqno(8)$$

Число уровней квантования в диапазоне от $ -U_0 $ до $ U_0 $:

$ N_у = \frac{U_0-(-U_0)}{\Delta u} + 1 = \frac{2U_0}{\Delta u}+1 $ , откуда шаг квантования $ \Delta u = \frac{2U_0}{N_у -1} $ .

Подставляя найденные выражения в формулу (8)

$ P_ш = \left.\left(\frac{2U_0}{N_у -1}\right)\right/12 = \frac{U_0^2}{3(N_н-1)^2} $ .

Соотношение сигнал --- шум по формуле (6):

$ h^2 =\left.\frac{U_0}{3}\right/\frac{U_0^2}{3(N_у-1)}= (N_у-1)^2 =99^2 =9801. $

\textbf{Ответ}: $h^2 = 9801  $.
